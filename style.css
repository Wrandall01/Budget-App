:root{--bg:#0f172a;--panel:#111827;--panel-2:#0b1220;--text:#e5e7eb;--muted:#94a3b8;--primary:#2563eb;--accent:#10b981;--danger:#ef4444;--violet:#8b5cf6;--border:#1f2937;--chip:#1f2937;--green:#22c55e;--red:#f43f5e;--donut-size:160px;--small-donut-size:120px}
*{box-sizing:border-box}html,body{width:100%}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,'Noto Sans',sans-serif;background:linear-gradient(180deg,#0b1220,#0f172a 35%,#0b1220);color:var(--text);overflow-x:hidden}.app{max-width:1100px;margin:24px auto;padding:0 16px}h2{margin:24px 0 12px;font-size:1.25rem}h3{margin:0 0 12px}.app-header{display:flex;justify-content:space-between;align-items:center;background:var(--panel);border:1px solid var(--border);padding:12px;border-radius:12px;margin-bottom:12px}.period-picker{display:flex;gap:10px;align-items:center;flex-wrap:wrap}.period-picker select{background:var(--panel-2);color:var(--text);border:1px solid var(--border);padding:8px;border-radius:8px;min-width:120px}.btn{border:none;border-radius:10px;padding:8px 12px;color:var(--text);cursor:pointer}.btn-primary{background:var(--primary)}.btn-accent{background:var(--accent);color:#062016}.btn-ghost{background:transparent;border:1px solid var(--border);color:var(--muted)}.btn-danger{background:var(--danger);color:#fff}.btn-icon .icon{margin-right:6px}.btn-plus-large{width:84px;height:84px;border-radius:50%;font-size:32px;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 20px rgba(16,185,129,.25)}.actions{display:flex;justify-content:center;margin:14px 0 22px}.section{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:14px;margin-bottom:16px}.summary-table{display:grid;gap:10px}.summary-header,.summary-row{display:grid;grid-template-columns:minmax(160px,1.4fr) 1fr 1fr 1fr 36px;gap:10px;align-items:center}.summary-header{color:var(--muted);font-weight:600;border-bottom:1px dashed var(--border);padding-bottom:8px}.summary-row{background:var(--panel-2);border:1px solid var(--border);border-radius:12px;padding:10px}.summary-row .title{display:flex;align-items:center;gap:8px;font-weight:600}.chips{display:flex;gap:6px;flex-wrap:wrap}.chip{background:var(--chip);color:var(--muted);padding:4px 8px;border-radius:999px;font-size:.8rem}.kebab{width:28px;height:28px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;display:flex;align-items:center;justify-content:center}.kebab:after{content:"⋯";font-size:18px;line-height:1}.kebab-menu{position:absolute;background:#0b1220;border:1px solid var(--border);border-radius:10px;padding:6px;display:none;z-index:10;min-width:180px}.kebab-menu button{width:100%;text-align:left;background:transparent;border:none;color:var(--text);padding:8px;border-radius:8px;cursor:pointer}.kebab-menu button:hover{background:var(--panel)}.details{margin:8px 0 0 0;border-left:2px dashed var(--border);padding-left:10px}.details-row{display:grid;grid-template-columns:120px 1fr 140px 36px;gap:8px;padding:6px 0;color:var(--muted);align-items:center}.cards{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:12px}.card{background:var(--panel-2);border:1px solid var(--border);border-radius:12px;padding:12px}.card .label{color:var(--muted);font-size:.9rem}.card .value{font-size:1.3rem;font-weight:700;margin-top:4px}.donut-wrapper{display:flex;align-items:center;justify-content:center;margin:8px 0;flex-direction:column}.donut-wrapper.big{height:240px}.donut-title{text-align:center;color:var(--muted);margin:0 0 8px 0;font-size:.95rem;font-weight:600}.donut{--size:var(--donut-size);width:var(--size);height:var(--size);border-radius:50%;position:relative;display:grid;place-items:center;background:conic-gradient(var(--red) 0deg var(--angle,0deg),var(--green) var(--angle,0deg) 360deg);box-shadow:0 8px 24px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.05)}.donut.violet{background:conic-gradient(var(--violet) 0deg 360deg)}.donut .center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:6px 10px;max-width:85%;margin:0 auto}.center .title{font-size:.85rem;color:var(--muted);margin-bottom:4px}.center .value{font-size:.9rem;line-height:1.2;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.donut-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px}.small-card{background:var(--panel-2);border:1px solid var(--border);border-radius:12px;padding:10px;display:flex;flex-direction:column;gap:8px}.small-card .name{font-weight:700}.small-card .donut{--size:var(--small-donut-size)}.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:100}.modal.hidden{display:none}.modal-content{width:min(520px,92vw);background:#0b1220;border:1px solid var(--border);border-radius:14px;padding:16px}.form-row{display:flex;flex-direction:column;gap:6px;margin-bottom:10px}.form-row input,.form-row select{padding:8px;border-radius:8px;border:1px solid var(--border);background:var(--panel);color:var(--text)}.modal-actions{display:flex;gap:8px;justify-content:flex-end}.toast{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);background:#0b1220;border:1px solid var(--border);padding:8px 12px;border-radius:10px;z-index:200}.toast.hidden{display:none}
@media (max-width:480px){.summary-header,.summary-row{grid-template-columns:minmax(120px,1.3fr) .9fr .9fr .9fr 32px}.summary-header{font-size:.9rem}.summary-row{font-size:.95rem}.chip{font-size:.75rem}.cards{grid-template-columns:1fr;gap:8px}.card .label{font-size:.85rem}.card .value{font-size:1.1rem}:root{--donut-size:132px;--small-donut-size:100px}.donut-grid{gap:10px}.details-row{grid-template-columns:96px 1fr 110px 32px;gap:6px}.app-header{padding:10px}.btn{padding:7px 10px}.btn-plus-large{width:70px;height:70px;font-size:28px}}
@media (max-width:360px){:root{--donut-size:120px;--small-donut-size:92px}.summary-header,.summary-row{grid-template-columns:minmax(110px,1.4fr) .8fr .8fr .8fr 28px}.details-row{grid-template-columns:86px 1fr 100px 28px}.donut-grid{gap:8px}.small-card{padding:8px}.center .value{font-size:.85rem}}
@media (max-width:820px){.cards{grid-template-columns:1fr}}
@media (min-width:821px){.donut-grid{grid-template-columns:repeat(3,minmax(0,1fr))}}



/* ===== Mobile reflow cohérent (<= 420px) ===== */
@media (max-width: 420px) {

  /* Cache la pastille annuelle / mensuelle sur petite écran */
  .summary-row .chips { display: none; }
}



/* ===== iOS: empêcher le zoom auto sur les champs ===== */
.form-row input,
.form-row select,
.form-row textarea {
  font-size: 16px;               /* clé anti-zoom iOS */
}

/* Renforcement spécifique iOS (Safari mobile) */
@supports (-webkit-touch-callout: none) {
  .form-row input,
  .form-row select,
  .form-row textarea {
    font-size: 16px !important;  /* évite les overrides plus haut */
  }
}

/* Évite le “gonflement” du texte en zoom */
html, body {
  -webkit-text-size-adjust: 100%;
}


/* ===== Donuts grid: alignement propre dans chaque carte ===== */
.donut-grid {
  align-items: stretch; /* toutes les cartes même hauteur */
}

/* Carte petite (titre + donut) : centre horizontalement le donut */
.small-card {
  display: grid;                     /* plus robuste que flex dans ce cas */
  grid-template-rows: auto 1fr;      /* titre, puis le donut prend la place */
  align-items: start;
  justify-items: center;             /* centre le donut horizontalement */
  row-gap: 8px;
}

/* Le titre reste aligné à gauche (mais la carte centre le donut) */
.small-card .name {
  justify-self: start;
}

/* Le donut est bien carré et centré dans la “case” */
.small-card .donut {
  width: var(--small-donut-size);
  height: var(--small-donut-size);
  max-width: 100%;
  aspect-ratio: 1 / 1;               /* garde le ratio si tailles varient */
  display: grid;
  place-items: center;               /* centre le contenu (texte “Restant”) */
  margin: 0;                         /* aucun décalage parasite */
}

/* Sur écrans très étroits, augmente la régularité d’alignement */
@media (max-width: 420px) {
  .donut-grid {
    grid-template-columns: 1fr;      /* 1 par ligne si besoin */
    gap: 10px;
  }
  .small-card {
    grid-template-rows: auto 1fr;
    padding: 10px;
  }
}

